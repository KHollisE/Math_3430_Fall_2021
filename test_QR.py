import QR
import pytest


pytest.main()

matrix_01 = [[1,-1,1],[1,0,1],[1,1,2]]
matrix_02 = [[2,-1,1],[1,0,3],[1,4,2]]

#Tests unstable_gram function
def test_Q_1():
    assert QR.Q(matrix_01) == ([[0.5773502691896258, -0.5773502691896258, 0.5773502691896258], [0.40824829046386274, 0.8164965809277261, 0.40824829046386274], [-0.7071067811865468, 6.280369834735101e-16, 0.7071067811865482]])
def test_Q_2():
    assert QR.Q(matrix_02) == ([[0.8164965809277261, -0.4082482904638631, 0.4082482904638631], [-0.2760262237369418, 0.3450327796711771, 0.8970852271450603], [0.50709255283711, 0.8451542547285165, -0.16903085094570308]])

#Tests stable_gram function
def test_stable_gram_1():
    assert QR.stable_gram(matrix_01) == ([[0.5773502691896258, -0.5773502691896258, 0.5773502691896258], [0.40824829046386274, 0.8164965809277261, 0.40824829046386274], [-0.7071067811865468, 6.280369834735101e-16, 0.7071067811865482]], [[1.7320508075688776, 0, 0], [1.1547005383792517, 0.816496580927726, 0], [1.1547005383792517, 2.0412414523193148, 0.7071067811865475]])
def test_stable_gram_2():
    assert QR.stable_gram(matrix_02) == ([[0.8164965809277261, -0.4082482904638631, 0.4082482904638631], [-0.2760262237369418, 0.3450327796711771, 0.8970852271450603], [0.50709255283711, 0.8451542547285165, -0.16903085094570308]], [[2.4494897427831783, 0, 0], [2.041241452319315, 2.4152294576982394, 0], [0.0, 2.8982753492378874, 3.5496478698597693]])
    
